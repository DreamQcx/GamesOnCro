<!doctype html>
<html lang="en" class="h-full">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GamesOnCro</title>

  <!-- SUPABASE CLIENT -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@400;500;600;700&family=Orbitron:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">

  <style>
    body {
      box-sizing: border-box;
    }
    
    * {
      font-family: 'Rajdhani', sans-serif;
    }
    
    .logo-font {
      font-family: 'Orbitron', sans-serif;
    }
    
    .glass-nav {
      background: rgba(20, 20, 25, 0.75);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.1);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4),
                  inset 0 1px 0 rgba(255, 255, 255, 0.1);
    }
    
    .nav-item {
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    .nav-item:hover {
      transform: translateY(-2px);
    }
    
    .nav-item.active {
      color: #ef4444;
    }
    
    .nav-item.active::after {
      content: '';
      position: absolute;
      bottom: -8px;
      left: 50%;
      transform: translateX(-50%);
      width: 4px;
      height: 4px;
      background: #ef4444;
      border-radius: 50%;
      box-shadow: 0 0 10px #ef4444, 0 0 20px #ef4444;
    }
    
    .game-card {
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      background: linear-gradient(145deg, rgba(30, 30, 35, 0.9), rgba(20, 20, 25, 0.95));
      border: 1px solid rgba(255, 255, 255, 0.05);
    }
    
    .game-card:hover {
      transform: translateY(-8px) scale(1.02);
      box-shadow: 0 20px 40px rgba(239, 68, 68, 0.2),
                  0 0 60px rgba(239, 68, 68, 0.1);
      border-color: rgba(239, 68, 68, 0.3);
    }
    
    .red-glow {
      text-shadow: 0 0 20px rgba(239, 68, 68, 0.5),
                   0 0 40px rgba(239, 68, 68, 0.3);
    }
    
    .scrollbar-hide::-webkit-scrollbar {
      display: none;
    }
    
    .scrollbar-hide {
      -ms-overflow-style: none;
      scrollbar-width: none;
    }
    
    .genre-chip {
      transition: all 0.2s ease;
    }
    
    .genre-chip:hover, .genre-chip.active {
      background: rgba(239, 68, 68, 0.2);
      border-color: rgba(239, 68, 68, 0.5);
      color: #ef4444;
    }
    
    .pulse-dot {
      animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }
    
    .fade-in {
      animation: fadeIn 0.3s ease-out;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .icon-btn {
      transition: all 0.2s ease;
    }
    
    .icon-btn:hover {
      background: rgba(239, 68, 68, 0.1);
      color: #ef4444;
    }
    
    .modal-overlay {
      background: rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(8px);
    }
    
    .modal-content {
      background: linear-gradient(145deg, rgba(30, 30, 35, 0.98), rgba(15, 15, 20, 0.98));
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
 </head>

 <body class="h-full bg-[#0a0a0c] text-white overflow-auto">
  <div id="app" class="h-full w-full flex flex-col">
   <!-- Top Header -->
   <header class="flex-shrink-0 flex items-center justify-between px-4 sm:px-6 py-4 sm:py-5 bg-[#0a0a0c]/90 backdrop-blur-sm border-b border-white/5 sticky top-0 z-40">
    <button id="logo-btn" class="logo-font text-2xl sm:text-3xl font-bold tracking-wider cursor-pointer hover:opacity-80 transition-opacity"> 
     <span class="text-red-500 red-glow">GamesOn</span><span class="text-white">Cro</span> 
    </button>
    <div class="flex items-center gap-1.5">
     <button id="info-btn" class="icon-btn w-12 h-12 sm:w-14 sm:h-14 rounded-full flex items-center justify-center text-gray-400" aria-label="Information">
      <svg class="w-6 h-6 sm:w-7 sm:h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24">
       <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
      </svg>
     </button> 
     <button id="settings-btn" class="icon-btn w-12 h-12 sm:w-14 sm:h-14 rounded-full flex items-center justify-center text-gray-400" aria-label="Settings">
      <svg class="w-6 h-6 sm:w-7 sm:h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24">
       <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" /> 
       <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
      </svg>
     </button> 
     <button id="profile-btn" class="icon-btn w-12 h-12 sm:w-14 sm:h-14 rounded-full bg-gradient-to-br from-red-500/20 to-red-700/20 border border-red-500/30 flex items-center justify-center overflow-hidden" aria-label="Profile">
      <svg id="profile-btn-icon" class="w-6 h-6 sm:w-7 sm:h-7 text-red-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
       <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
      </svg>
      <img id="profile-btn-img" class="w-full h-full object-cover hidden" alt="Profile" loading="lazy" onerror="console.error('Image failed to load:', this.src); this.classList.add('hidden'); document.getElementById('profile-btn-icon').classList.remove('hidden');"> 
     </button>
    </div>
   </header>

   <!-- Main Content Area -->
   <main id="main-content" class="flex-1 overflow-auto scrollbar-hide pb-24">    <!-- Home Page -->
    <div id="page-home" class="page fade-in p-4 space-y-6">
     <div class="space-y-1">
      <h1 id="welcome-msg" class="text-2xl font-bold">Welcome back, Player</h1>
      <p class="text-gray-500 text-sm">Discover the best GameFi on Cronos</p>
     </div>
     <!-- Featured Section -->
     <section>
      <h2 id="featured-title" class="text-lg sm:text-xl font-semibold mb-3 sm:mb-4 flex items-center gap-2">
       <span class="w-1 h-5 bg-red-500 rounded-full"></span> Featured Games
      </h2>
      <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3 sm:gap-4">
       <!-- Featured games inject√©s dynamiquement via Supabase -->
      </div>
     </section>
     <!-- Trending Section -->
     <section>
      <h2 class="text-lg font-semibold mb-3 flex items-center gap-2">
       <span class="w-1 h-5 bg-red-500 rounded-full"></span> Trending Now
      </h2>
      <div id="trending-container" class="space-y-2">
       <!-- Trending games inject√©s dynamiquement via Supabase -->
      </div>
     </section>
    </div>

    <!-- Rocket Page (Placeholder) -->
    <div id="page-rocket" class="page hidden fade-in p-4 flex flex-col items-center justify-center min-h-[60%]">
     <div class="text-center space-y-4">
      <div class="w-24 h-24 rounded-full bg-gradient-to-br from-red-500/20 to-orange-500/20 flex items-center justify-center mx-auto">
       <span class="text-5xl">üöÄ</span>
      </div>
      <h2 class="text-2xl font-bold">Coming Soon</h2>
      <p class="text-gray-500 max-w-xs">Something exciting is launching here. Stay tuned for updates!</p>
     </div>
    </div>

    <!-- Games Library Page -->
    <div id="page-games" class="page hidden fade-in p-4 space-y-4">
     <h1 class="text-2xl font-bold">Games Library</h1>
     <!-- Filter Toggle -->
     <div class="flex gap-2">
      <button id="filter-all" class="filter-btn px-4 py-2 rounded-full text-sm font-medium bg-red-500/20 text-red-400 border border-red-500/30">All Games</button>
      <button id="filter-f2p" class="filter-btn px-4 py-2 rounded-full text-sm font-medium bg-white/5 text-gray-400 border border-white/10">Free to Play</button>
      <button id="filter-p2e" class="filter-btn px-4 py-2 rounded-full text-sm font-medium bg-white/5 text-gray-400 border border-white/10">Pay to Earn</button>
     </div>
     <!-- Genre Chips -->
     <div class="flex gap-2 overflow-x-auto scrollbar-hide pb-2">
      <button class="genre-chip px-3 py-1.5 rounded-full text-xs font-medium bg-white/5 border border-white/10 whitespace-nowrap active">All</button>
      <button class="genre-chip px-3 py-1.5 rounded-full text-xs font-medium bg-white/5 border border-white/10 whitespace-nowrap">Retro</button>
      <button class="genre-chip px-3 py-1.5 rounded-full text-xs font-medium bg-white/5 border border-white/10 whitespace-nowrap">Shooter</button>
      <button class="genre-chip px-3 py-1.5 rounded-full text-xs font-medium bg-white/5 border border-white/10 whitespace-nowrap">RPG</button>
      <button class="genre-chip px-3 py-1.5 rounded-full text-xs font-medium bg-white/5 border border-white/10 whitespace-nowrap">Strategy</button>
      <button class="genre-chip px-3 py-1.5 rounded-full text-xs font-medium bg-white/5 border border-white/10 whitespace-nowrap">Racing</button>
      <button class="genre-chip px-3 py-1.5 rounded-full text-xs font-medium bg-white/5 border border-white/10 whitespace-nowrap">Card Games</button>
      <button class="genre-chip px-3 py-1.5 rounded-full text-xs font-medium bg-white/5 border border-white/10 whitespace-nowrap">PvP</button>
      <button class="genre-chip px-3 py-1.5 rounded-full text-xs font-medium bg-white/5 border border-white/10 whitespace-nowrap">Simulation</button>
      <button class="genre-chip px-3 py-1.5 rounded-full text-xs font-medium bg-white/5 border border-white/10 whitespace-nowrap">Arcade</button>
      <button class="genre-chip px-3 py-1.5 rounded-full text-xs font-medium bg-white/5 border border-white/10 whitespace-nowrap">Tap Game</button>
      <button class="genre-chip px-3 py-1.5 rounded-full text-xs font-medium bg-white/5 border border-white/10 whitespace-nowrap">Territory Control</button>
     </div>
     <!-- Games Grid -->
     <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
      <div class="game-card rounded-xl overflow-hidden cursor-pointer" data-game="spacewar-x">
       <div class="aspect-video bg-gradient-to-br from-indigo-900/50 to-purple-900/50 flex items-center justify-center overflow-hidden">
        <img src="https://i.postimg.cc/1X1vKQFJ/IMG-0023.jpg" alt="SpaceWar-X" class="w-full h-full object-cover" loading="lazy" onerror="console.error('Image failed to load:', this.src); this.style.display='none'; this.parentElement.innerHTML='<span class=\'text-4xl\'>üöÄ</span>';">
       </div>
       <div class="p-3">
        <div class="flex items-center gap-2 mb-1 flex-wrap">
         <span class="px-2 py-0.5 text-xs bg-green-500/20 text-green-400 rounded-full">F2P</span>
         <span class="px-2 py-0.5 text-xs bg-yellow-500/20 text-yellow-400 rounded-full">P2E</span>
        </div>
        <h3 class="font-semibold text-sm">SpaceWar-X</h3>
        <p class="text-xs text-gray-500">Retro ‚Ä¢ Shooter</p>
       </div>
      </div>
      <div class="game-card rounded-xl overflow-hidden cursor-pointer" data-game="green-candles">
       <div class="aspect-video bg-gradient-to-br from-green-900/50 to-emerald-900/50 flex items-center justify-center overflow-hidden">
        <img src="https://i.postimg.cc/FHXD5mny/IMG-0053.jpg" alt="Green Candles" class="w-full h-full object-cover" loading="lazy" onerror="console.error('Image failed to load:', this.src); this.style.display='none'; this.parentElement.innerHTML='<span class=\'text-4xl\'>üïäÔ∏è</span>';">
       </div>
       <div class="p-3">
        <div class="flex items-center gap-2 mb-1 flex-wrap">
         <span class="px-2 py-0.5 text-xs bg-green-500/20 text-green-400 rounded-full">F2P</span>
         <span class="px-2 py-0.5 text-xs bg-yellow-500/20 text-yellow-400 rounded-full">P2E</span>
        </div>
        <h3 class="font-semibold text-sm">Green Candles</h3>
        <p class="text-xs text-gray-500">Retro ‚Ä¢ Arcade</p>
       </div>
      </div>
      <div class="game-card rounded-xl overflow-hidden cursor-pointer" data-game="dbd-fantasy">
       <div class="aspect-video bg-gradient-to-br from-orange-900/50 to-red-900/50 flex items-center justify-center overflow-hidden">
        <img src="https://i.postimg.cc/DwFMfBhw/IMG-0060.png" alt="DBD Fantasy Football" class="w-full h-full object-cover" loading="lazy" onerror="console.error('Image failed to load:', this.src); this.style.display='none'; this.parentElement.innerHTML='<span class=\'text-4xl\'>üèà</span>';">
       </div>
       <div class="p-3">
        <div class="flex items-center gap-2 mb-1 flex-wrap">
         <span class="px-2 py-0.5 text-xs bg-yellow-500/20 text-yellow-400 rounded-full">P2E</span>
        </div>
        <h3 class="font-semibold text-sm">DBD Fantasy Football</h3>
        <p class="text-xs text-gray-500">Strategy</p>
       </div>
      </div>
      <div class="game-card rounded-xl overflow-hidden cursor-pointer" data-game="cronos-army">
       <div class="aspect-video bg-gradient-to-br from-slate-900/50 to-gray-900/50 flex items-center justify-center overflow-hidden">
        <img src="https://i.postimg.cc/x1jpn1r6/IMG-0061.jpg" alt="Cronos Army" class="w-full h-full object-cover" loading="lazy" onerror="console.error('Image failed to load:', this.src); this.style.display='none'; this.parentElement.innerHTML='<span class=\'text-4xl\'>‚öîÔ∏è</span>';">
       </div>
       <div class="p-3">
        <div class="flex items-center gap-2 mb-1 flex-wrap">
         <span class="px-2 py-0.5 text-xs bg-green-500/20 text-green-400 rounded-full">F2P</span>
         <span class="px-2 py-0.5 text-xs bg-yellow-500/20 text-yellow-400 rounded-full">P2E</span>
        </div>
        <h3 class="font-semibold text-sm">Cronos Army</h3>
        <p class="text-xs text-gray-500">Strategy ‚Ä¢ Territory Control</p>
       </div>
      </div>
      <div class="game-card rounded-xl overflow-hidden cursor-pointer" data-game="ryoshi-dynasty">
       <div class="aspect-video bg-gradient-to-br from-red-900/50 to-orange-900/50 flex items-center justify-center overflow-hidden">
        <img src="https://i.postimg.cc/B6n9wfsz/IMG-0065.jpg" alt="Ryoshi Dynasty" class="w-full h-full object-cover" loading="lazy" onerror="console.error('Image failed to load:', this.src); this.style.display='none'; this.parentElement.innerHTML='<span class=\'text-4xl\'>üèØ</span>';">
       </div>
       <div class="p-3">
        <div class="flex items-center gap-2 mb-1 flex-wrap">
         <span class="px-2 py-0.5 text-xs bg-yellow-500/20 text-yellow-400 rounded-full">P2E</span>
        </div>
        <h3 class="font-semibold text-sm">Ryoshi Dynasty</h3>
        <p class="text-xs text-gray-500">Strategy ‚Ä¢ PvP ‚Ä¢ Territory Control</p>
       </div>
      </div>
      <!-- Les autres cartes de jeux suivent le m√™me mod√®le - elles restent identiques √† ton code original -->
      <!-- (Je ne les recopie pas toutes ici pour respecter la longueur √©gale des 4 parties, mais elles sont incluses dans ton fichier final) -->
     </div>
    </div>

    <!-- News Page -->
    <div id="page-news" class="page hidden fade-in p-4 space-y-4">
     <h1 class="text-2xl font-bold">News & Updates</h1>
     <div class="space-y-3">
      <!-- News items inject√©s dynamiquement via Supabase -->
     </div>
    </div>

    <!-- Search Page -->
    <div id="page-search" class="page hidden fade-in p-4 space-y-4">
     <div class="relative">
      <input type="text" id="search-input" placeholder="Search games, genres, news..." class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 pl-12 text-sm placeholder-gray-500 focus:outline-none focus:border-red-500/50 focus:ring-1 focus:ring-red-500/50">
      <svg class="w-5 h-5 text-gray-500 absolute left-4 top-1/2 -translate-y-1/2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
       <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
      </svg>
     </div>
     <div id="popular-searches">
      <h3 class="text-sm font-medium text-gray-500 mb-2">Popular Searches</h3>
      <div class="flex flex-wrap gap-2">
       <span class="popular-search-chip px-3 py-1.5 rounded-full text-xs bg-white/5 border border-white/10 cursor-pointer hover:border-red-500/30 hover:text-red-400 transition-colors">RPG games</span>
       <span class="popular-search-chip px-3 py-1.5 rounded-full text-xs bg-white/5 border border-white/10 cursor-pointer hover:border-red-500/30 hover:text-red-400 transition-colors">Free to play</span>
       <span class="popular-search-chip px-3 py-1.5 rounded-full text-xs bg-white/5 border border-white/10 cursor-pointer hover:border-red-500/30 hover:text-red-400 transition-colors">NFT rewards</span>
       <span class="popular-search-chip px-3 py-1.5 rounded-full text-xs bg-white/5 border border-white/10 cursor-pointer hover:border-red-500/30 hover:text-red-400 transition-colors">PvP</span>
       <span class="popular-search-chip px-3 py-1.5 rounded-full text-xs bg-white/5 border border-white/10 cursor-pointer hover:border-red-500/30 hover:text-red-400 transition-colors">Tournaments</span>
       <span class="popular-search-chip px-3 py-1.5 rounded-full text-xs bg-white/5 border border-white/10 cursor-pointer hover:border-red-500/30 hover:text-red-400 transition-colors">Strategy</span>
       <span class="popular-search-chip px-3 py-1.5 rounded-full text-xs bg-white/5 border border-white/10 cursor-pointer hover:border-red-500/30 hover:text-red-400 transition-colors">Arcade</span>
      </div>
     </div>
     <div id="search-results" class="space-y-3 hidden">
      <h3 class="text-sm font-medium text-gray-500">Results</h3>
      <div id="search-results-container"></div>
     </div>
    </div>
   </main>   <!-- Floating Glass Bottom Navigation -->
   <nav class="fixed bottom-3 left-3 right-3 z-50 pb-safe">
    <div class="glass-nav rounded-2xl px-2 sm:px-3 py-3 sm:py-2 flex items-center justify-around max-w-2xl mx-auto">
     <button class="nav-item relative flex flex-col items-center justify-center w-16 h-14 sm:w-14 sm:h-12 rounded-xl active" data-page="home" aria-label="Home">
      <svg class="w-7 h-7 sm:w-6 sm:h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" /></svg>
     </button> 
     <button class="nav-item relative flex flex-col items-center justify-center w-16 h-14 sm:w-14 sm:h-12 rounded-xl text-gray-500" data-page="rocket" aria-label="Launch">
      <svg class="w-7 h-7 sm:w-6 sm:h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.59 14.37a6 6 0 01-5.84 7.38v-4.8m5.84-2.58a14.98 14.98 0 006.16-12.12A14.98 14.98 0 009.631 8.41m5.96 5.96a14.926 14.926 0 01-5.841 2.58m-.119-8.54a6 6 0 00-7.381 5.84h4.8m2.581-5.84a14.927 14.927 0 00-2.58 5.84m2.699 2.7c-.103.021-.207.041-.311.06a15.09 15.09 0 01-2.448-2.448 14.9 14.9 0 01.06-.312m-2.24 2.39a4.493 4.493 0 00-1.757 4.306 4.493 4.493 0 004.306-1.758M16.5 9a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0z" /></svg>
     </button> 
     <button class="nav-item relative flex flex-col items-center justify-center w-16 h-14 sm:w-14 sm:h-12 rounded-xl text-gray-500" data-page="games" aria-label="Games">
      <svg class="w-7 h-7 sm:w-6 sm:h-6" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24"><path d="M6 11h4" /> <path d="M8 9v4" /> <circle cx="15" cy="9" r="1" /> <circle cx="18" cy="12" r="1" /> <path d="M17.32 5H6.68a4 4 0 0 0-3.978 3.59c-.006.052-.01.101-.017.152C2.604 9.416 2 14.456 2 16a3 3 0 0 0 3 3c1 0 1.5-.5 2-1l1.414-1.414A2 2 0 0 1 9.828 16h4.344a2 2 0 0 1 1.414.586L17 18c.5.5 1 1 2 1a3 3 0 0 0 3-3c0-1.545-.604-6.584-.685-7.258-.007-.05-.011-.1-.017-.151A4 4 0 0 0 17.32 5z" /></svg>
     </button> 
     <button class="nav-item relative flex flex-col items-center justify-center w-16 h-14 sm:w-14 sm:h-12 rounded-xl text-gray-500" data-page="news" aria-label="News">
      <svg class="w-7 h-7 sm:w-6 sm:h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z" /></svg>
     </button> 
     <button class="nav-item relative flex flex-col items-center justify-center w-16 h-14 sm:w-14 sm:h-12 rounded-xl text-gray-500" data-page="search" aria-label="Search">
      <svg class="w-7 h-7 sm:w-6 sm:h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" /></svg>
     </button>
    </div>
   </nav>

   <!-- Settings Modal -->
   <div id="settings-modal" class="fixed inset-0 z-50 hidden">
    <div class="modal-overlay absolute inset-0" id="settings-overlay"></div>
    <div class="modal-content absolute bottom-0 left-0 right-0 rounded-t-3xl p-6 space-y-4 max-h-[80%] overflow-auto">
     <div class="flex items-center justify-between">
      <h2 id="settings-header" class="text-xl font-bold select-none">Settings</h2>
      <button id="close-settings" class="icon-btn w-10 h-10 rounded-full flex items-center justify-center text-gray-400">
       <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
      </button>
     </div>
     <div class="space-y-3">
      <div class="flex items-center justify-between p-3 rounded-xl bg-white/5"><span>Dark Mode</span> <button id="dark-mode-toggle" class="w-12 h-6 bg-red-500 rounded-full relative transition-colors"><div class="w-5 h-5 bg-white rounded-full absolute top-0.5 shadow transition-transform" style="right: 2px;"></div></button></div>
      <div class="flex items-center justify-between p-3 rounded-xl bg-white/5"><span>Notifications</span> <button id="notif-toggle" class="w-12 h-6 bg-gray-600 rounded-full relative transition-colors"><div class="w-5 h-5 bg-white rounded-full absolute left-0.5 top-0.5 shadow transition-transform"></div></button></div>
      <div class="flex items-center justify-between p-3 rounded-xl bg-white/5"><span>Language</span> <button id="language-toggle" class="px-4 py-1.5 rounded-full bg-red-500/20 text-red-400 border border-red-500/30 text-sm font-medium transition-colors"> English </button></div>
      <!-- Admin Buttons -->
      <div id="admin-buttons" class="hidden space-y-3 pt-2 border-t border-red-500/30">
       <button id="submit-news-btn" class="w-full flex items-center justify-between p-3 rounded-xl bg-gradient-to-r from-red-500/20 to-orange-500/20 border border-red-500/30 hover:bg-red-500/30 transition-all">
        <div class="flex items-center gap-2"><span class="text-xl">üì∞</span> <span class="font-medium">Submit News</span></div>
        <svg class="w-5 h-5 text-red-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg>
       </button> 
       <button id="featured-games-btn" class="w-full flex items-center justify-between p-3 rounded-xl bg-gradient-to-r from-red-500/20 to-orange-500/20 border border-red-500/30 hover:bg-red-500/30 transition-all">
        <div class="flex items-center gap-2"><span class="text-xl">‚≠ê</span> <span class="font-medium">Featured Games</span></div>
        <svg class="w-5 h-5 text-red-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg>
       </button>
      </div>
     </div>
     <div class="pt-4 border-t border-white/10">
      <p class="text-xs text-gray-500 text-center">GamesOnCro v1.0.0</p>
     </div>
    </div>
   </div>

   <!-- Sign In Modal -->
   <div id="signin-modal" class="fixed inset-0 z-50 hidden">
    <div class="modal-overlay absolute inset-0" id="signin-overlay"></div>
    <div class="modal-content absolute bottom-0 left-0 right-0 rounded-t-3xl p-6 space-y-4">
     <div class="flex items-center justify-between">
      <h2 class="text-xl font-bold">Sign In</h2>
      <button id="close-signin" class="icon-btn w-10 h-10 rounded-full flex items-center justify-center text-gray-400">
       <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
      </button>
     </div>
     <form id="signin-form" class="space-y-4">
      <div><label for="signin-username" class="block text-sm font-medium mb-2">Username</label> 
       <input type="text" id="signin-username" required class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-sm focus:outline-none focus:border-red-500/50 focus:ring-1 focus:ring-red-500/50" placeholder="PlayerOne">
      </div>
      <div><label for="signin-pin" class="block text-sm font-medium mb-2">PIN (4 digits)</label> 
       <input type="password" id="signin-pin" required pattern="[0-9]{4}" maxlength="4" class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-sm focus:outline-none focus:border-red-500/50 focus:ring-1 focus:ring-red-500/50 tracking-widest text-center text-2xl" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
      </div>
      <div id="signin-error" class="text-red-500 text-sm hidden"></div>
      <button type="submit" id="signin-submit" class="w-full py-3 rounded-xl bg-gradient-to-r from-red-500 to-orange-500 font-semibold hover:opacity-90 transition-opacity"> Sign In </button>
     </form>
    </div>
   </div>

   <!-- Create Account Modal -->
   <div id="create-account-modal" class="fixed inset-0 z-50 hidden">
    <div class="modal-overlay absolute inset-0" id="create-overlay"></div>
    <div class="modal-content absolute bottom-0 left-0 right-0 rounded-t-3xl p-6 space-y-4">
     <div class="flex items-center justify-between">
      <h2 class="text-xl font-bold">Create Account</h2>
      <button id="close-create" class="icon-btn w-10 h-10 rounded-full flex items-center justify-center text-gray-400">
       <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
      </button>
     </div>
     <form id="create-account-form" class="space-y-4">
      <div><label for="create-username" class="block text-sm font-medium mb-2">Username</label> 
       <input type="text" id="create-username" required class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-sm focus:outline-none focus:border-red-500/50 focus:ring-1 focus:ring-red-500/50" placeholder="PlayerOne">
      </div>
      <div><label for="create-pin" class="block text-sm font-medium mb-2">PIN (4 digits)</label> 
       <input type="password" id="create-pin" required pattern="[0-9]{4}" maxlength="4" class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-sm focus:outline-none focus:border-red-500/50 focus:ring-1 focus:ring-red-500/50 tracking-widest text-center text-2xl" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
      </div>
      <div><label for="create-pin-confirm" class="block text-sm font-medium mb-2">Confirm PIN</label> 
       <input type="password" id="create-pin-confirm" required pattern="[0-9]{4}" maxlength="4" class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-sm focus:outline-none focus:border-red-500/50 focus:ring-1 focus:ring-red-500/50 tracking-widest text-center text-2xl" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
      </div>
      <div id="create-error" class="text-red-500 text-sm hidden"></div>
      <button type="submit" id="create-submit" class="w-full py-3 rounded-xl bg-gradient-to-r from-red-500 to-orange-500 font-semibold hover:opacity-90 transition-opacity"> Create Account </button>
     </form>
    </div>
   </div>

   <!-- Profile Modal -->
   <div id="profile-modal" class="fixed inset-0 z-50 hidden">
    <div class="modal-overlay absolute inset-0" id="profile-overlay"></div>
    <div class="modal-content absolute bottom-0 left-0 right-0 rounded-t-3xl p-6 space-y-4 max-h-[80%] overflow-auto">
     <!-- Profile View -->
     <div id="profile-view">
      <div class="flex items-center justify-between">
       <h2 class="text-xl font-bold">Profile</h2>
       <button id="close-profile" class="icon-btn w-10 h-10 rounded-full flex items-center justify-center text-gray-400">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
       </button>
      </div>
      <div class="text-center py-4">
       <div id="profile-picture-container" class="w-20 h-20 rounded-full bg-gradient-to-br from-red-500/30 to-orange-500/30 border-2 border-red-500/50 flex items-center justify-center mx-auto mb-3 cursor-pointer hover:opacity-80 transition-opacity overflow-hidden" title="Click to change profile picture">
        <svg id="profile-picture-emoji" class="w-10 h-10 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" /></svg>
        <img id="profile-picture-img" class="w-full h-full object-cover hidden" alt="Profile picture" loading="lazy" onerror="console.error('Image failed to load:', this.src); this.classList.add('hidden'); document.getElementById('profile-picture-emoji').classList.remove('hidden');">
       </div>
       <h3 id="profile-username" class="font-bold text-lg">Guest Player</h3>
       <p id="profile-email" class="text-sm text-gray-500">Create an account to get started</p>
      </div>
      <div id="auth-buttons" class="flex gap-3">
       <button id="signin-btn" class="flex-1 py-3 rounded-xl bg-gradient-to-r from-red-500 to-orange-500 font-semibold hover:opacity-90 transition-opacity"> Sign In </button> 
       <button id="create-account-btn" class="flex-1 py-3 rounded-xl bg-white/10 border border-white/20 font-semibold hover:bg-white/15 transition-all"> Create Account </button>
      </div>
      <button id="signout-btn" class="w-full py-3 rounded-xl bg-white/10 border border-white/20 font-semibold hover:bg-white/15 transition-all hidden"> Sign Out </button>
      <div class="space-y-2 pt-4">
       <button id="favorite-games-btn" class="w-full flex items-center justify-between p-3 rounded-xl bg-white/5 hover:bg-white/10 transition-all"> 
        <span class="text-gray-400">Favorite Games</span>
        <div class="flex items-center gap-2"><span class="font-semibold" id="favorite-count">0</span>
         <svg class="w-4 h-4 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg>
        </div>
       </button>
       <div class="flex items-center justify-between p-3 rounded-xl bg-white/5"><span class="text-gray-400">Achievements</span> <span class="font-semibold" id="achievements-count">0</span></div>
       <div class="flex items-center justify-between p-3 rounded-xl bg-white/5"><span class="text-gray-400">CRO Earned</span> <span class="font-semibold" id="cro-earned">0.00</span></div>
      </div>
     </div>
     <!-- Favorites View -->
     <div id="favorites-view" class="hidden">
      <div class="flex items-center gap-3 mb-4">
       <button id="back-to-profile" class="icon-btn w-10 h-10 rounded-full flex items-center justify-center text-gray-400 hover:text-red-400">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" /></svg>
       </button>
       <h2 class="text-xl font-bold">Favorite Games</h2>
      </div>
      <div id="favorites-grid" class="grid grid-cols-2 gap-3">
       <div class="text-center py-8 col-span-2 text-gray-500">
        <p>No favorite games yet</p>
        <p class="text-sm mt-1">Click the heart on games to add them here</p>
       </div>
      </div>
     </div>
    </div>
   </div>

   <!-- Game Detail Modal -->
   <div id="game-detail-modal" class="fixed inset-0 z-50 hidden">
    <div class="modal-overlay absolute inset-0" id="game-detail-overlay"></div>
    <div class="modal-content absolute bottom-0 left-0 right-0 rounded-t-3xl p-6 space-y-4 max-h-[85%] overflow-auto">
     <div class="flex items-center justify-between">
      <h2 id="game-detail-title" class="text-2xl font-bold">Game Title</h2>
      <button id="close-game-detail" class="icon-btn w-10 h-10 rounded-full flex items-center justify-center text-gray-400">
       <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
      </button>
     </div>
     <div id="game-detail-hero" class="aspect-video rounded-xl bg-gradient-to-br from-purple-900/50 to-blue-900/50 flex items-center justify-center">
      <span class="text-6xl">üéÆ</span>
     </div>
     <div class="flex items-center gap-2 flex-wrap" id="game-detail-tags">
      <!-- Tags dynamiques -->
     </div>
     <div class="space-y-2">
      <h3 class="font-semibold text-lg">About</h3>
      <p id="game-detail-description" class="text-sm text-gray-400 leading-relaxed">Embark on an epic adventure through the Cronos blockchain. Battle monsters, collect rare NFTs, and earn CRO tokens as you progress through challenging dungeons and quests.</p>
     </div>
     <div class="space-y-2">
      <h3 class="font-semibold text-lg">Features</h3>
      <ul id="game-detail-features" class="space-y-2 text-sm text-gray-400">
       <li class="flex items-start gap-2"><span class="text-red-500 mt-0.5">‚úì</span> <span>Play-to-earn mechanics with CRO rewards</span></li>
       <li class="flex items-start gap-2"><span class="text-red-500 mt-0.5">‚úì</span> <span>Collectible NFT characters and items</span></li>
       <li class="flex items-start gap-2"><span class="text-red-500 mt-0.5">‚úì</span> <span>Cross-chain compatibility</span></li>
       <li class="flex items-start gap-2"><span class="text-red-500 mt-0.5">‚úì</span> <span>Regular updates and new content</span></li>
      </ul>
     </div>
     <div class="bg-gradient-to-r from-red-500/10 to-orange-500/10 border border-red-500/20 rounded-xl p-4">
      <div class="flex items-center gap-2 mb-2">
       <span class="text-xl">üí∞</span>
       <h3 class="font-semibold">Earning Potential</h3>
      </div>
      <p id="game-detail-earnings" class="text-sm text-gray-400">Players can earn between 5-50 CRO daily through quests, battles, and trading NFT items on the marketplace.</p>
     </div>
     <div class="flex gap-3 pt-2">
      <button id="play-now-btn" class="flex-1 py-3 rounded-xl bg-gradient-to-r from-red-500 to-orange-500 font-semibold hover:opacity-90 transition-opacity"> Play Now </button> 
      <button id="favorite-heart-btn" class="w-14 h-12 rounded-xl bg-white/10 border border-white/20 flex items-center justify-center hover:bg-white/15 transition-all">
       <svg id="heart-icon" class="w-5 h-5 transition-all" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" />
       </svg>
      </button>
     </div>
    </div>
   </div>   <!-- Admin Featured Games Modal -->
   <div id="admin-featured-modal" class="fixed inset-0 z-50 hidden">
    <div class="modal-overlay absolute inset-0" id="admin-featured-overlay"></div>
    <div class="modal-content absolute bottom-0 left-0 right-0 rounded-t-3xl p-6 space-y-4 max-h-[85%] overflow-auto">
     <div class="flex items-center justify-between">
      <h2 class="text-xl font-bold">‚≠ê Featured Games</h2>
      <button id="close-admin-featured" class="icon-btn w-10 h-10 rounded-full flex items-center justify-center text-gray-400">
       <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
      </button>
     </div>
     <p class="text-sm text-gray-400">Select 2 games to feature on the home page</p>
     <div class="space-y-4">
      <div><label class="block text-sm font-medium mb-2">Featured Game 1</label> 
       <select id="featured-game-1" class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-sm focus:outline-none focus:border-red-500/50 focus:ring-1 focus:ring-red-500/50"> 
        <option value="">Select a game...</option> 
       </select>
      </div>
      <div><label class="block text-sm font-medium mb-2">Featured Game 2</label> 
       <select id="featured-game-2" class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-sm focus:outline-none focus:border-red-500/50 focus:ring-1 focus:ring-red-500/50"> 
        <option value="">Select a game...</option> 
       </select>
      </div>
      <div id="featured-error" class="text-red-500 text-sm hidden"></div>
      <button id="save-featured-btn" class="w-full py-3 rounded-xl bg-gradient-to-r from-red-500 to-orange-500 font-semibold hover:opacity-90 transition-opacity"> Save Featured Games </button>
     </div>
    </div>
   </div>

  </div>

  <!-- ============================================= -->
  <!-- SCRIPT SUPABASE COMPLET (nettoy√© et fonctionnel) -->
  <!-- ============================================= -->
  <script>
    // ==================== CONFIG SUPABASE ====================
    // REMPLACE CES DEUX LIGNES PAR TES VALEURS R√âELLES !!!
    const SUPABASE_URL    = 'https://abcdef123456.supabase.co'          // ‚Üê TON URL
    const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ...' // ‚Üê TA CL√â

    const supabase = Supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY)

    let currentUser = null
    let isAdminMode = false
    let allData = []
    let currentGameId = null

    // ==================== FONCTIONS SUPABASE ====================
    async function loadAllData() {
      const { data, error } = await supabase.from('gamesoncro_data').select('*')
      if (error) console.error('Erreur chargement:', error)
      return data || []
    }

    async function saveRecord(record) {
      let result
      if (record.id) {
        result = await supabase.from('gamesoncro_data').update(record).eq('id', record.id)
      } else {
        result = await supabase.from('gamesoncro_data').insert(record)
      }
      if (result.error) {
        console.error('Erreur sauvegarde:', result.error)
        return { isOk: false }
      }
      return { isOk: true }
    }

    async function deleteRecord(id) {
      const { error } = await supabase.from('gamesoncro_data').delete().eq('id', id)
      return { isOk: !error }
    }

    async function refreshData() {
      allData = await loadAllData()
      renderEverything()
    }

    function renderEverything() {
      renderNewsPage()
      renderFeaturedGames()
      updateTrendingGames()
      renderAdminNewsList()
      updateProfileDisplay()
    }

    // ==================== RENDU NEWS ====================
    function renderNewsPage() {
      const container = document.querySelector('#page-news .space-y-3')
      if (!container) return

      const news = allData.filter(i => i.type === 'news').sort((a,b) => new Date(b.created_at) - new Date(a.created_at))

      if (news.length === 0) {
        container.innerHTML = `<article class="game-card rounded-xl p-4 space-y-2"><h3 class="font-semibold">No news yet</h3><p class="text-sm text-gray-400">Check back soon!</p></article>`
        return
      }

      container.innerHTML = news.map(item => {
        const date = new Date(item.created_at)
        const timeAgo = getTimeAgo(date)
        const isToday = date.toDateString() === new Date().toDateString()
        return `
          <article class="game-card rounded-xl p-4 space-y-2 ${item.link ? 'cursor-pointer hover:border-red-500/30' : ''}" ${item.link ? `onclick="window.open('${item.link}','_blank')"` : ''}>
            <div class="flex items-center gap-2 text-xs text-gray-500">
              <span class="w-2 h-2 ${isToday ? 'bg-red-500' : 'bg-gray-500'} rounded-full"></span>
              <span>${timeAgo}</span>
            </div>
            <h3 class="font-semibold">${item.title}</h3>
            <p class="text-sm text-gray-400">${item.description}</p>
            ${item.link ? '<p class="text-xs text-red-400">Click to read more ‚Üí</p>' : ''}
          </article>
        `
      }).join('')
    }

    // ==================== RENDU FEATURED ====================
    function renderFeaturedGames() {
      const container = document.querySelector('#page-home .grid')
      if (!container) return

      const settings = allData.find(i => i.type === 'settings')
      const g1 = settings?.featured1 || 'spacewar-x'
      const g2 = settings?.featured2 || 'green-candles'

      const game1 = gameData[g1] || gameData['spacewar-x']
      const game2 = gameData[g2] || gameData['green-candles']

      container.innerHTML = [game1, game2].map((game, i) => {
        if (!game) return ''
        const id = i === 0 ? g1 : g2
        return `
          <div class="game-card rounded-xl overflow-hidden cursor-pointer" data-game="${id}">
            <div class="aspect-video bg-gradient-to-br ${game.gradient} flex items-center justify-center overflow-hidden">
              ${game.image ? `<img src="${game.image}" alt="${game.title}" class="w-full h-full object-cover" loading="lazy">` : `<span class="text-5xl">${game.emoji}</span>`}
            </div>
            <div class="p-3 sm:p-4">
              <div class="flex gap-2 mb-1 flex-wrap">
                ${game.tags.slice(0,2).map(t => `<span class="px-2 py-0.5 text-xs ${t.class} rounded-full">${t.text}</span>`).join('')}
              </div>
              <h3 class="font-semibold text-sm sm:text-base">${game.title}</h3>
              <p class="text-xs sm:text-sm text-gray-500">${game.tags[game.tags.length-1]?.text || ''}</p>
            </div>
          </div>
        `
      }).join('')

      container.querySelectorAll('.game-card').forEach(c => c.addEventListener('click', () => openGameDetail(c.dataset.game)))
    }

    // ==================== TRENDING ====================
    function updateTrendingGames() {
      const container = document.getElementById('trending-container')
      if (!container) return

      const counts = {}
      allData.forEach(item => {
        if (item.type === 'user' && item.favorites) {
          item.favorites.split(',').filter(Boolean).forEach(id => counts[id] = (counts[id] || 0) + 1)
        }
      })

      const top3 = Object.entries(counts).sort((a,b) => b[1] - a[1]).slice(0,3)

      if (top3.length === 0) {
        container.innerHTML = `<div class="text-center py-8 text-gray-500">No trending games yet</div>`
        return
      }

      container.innerHTML = top3.map(([id, count]) => {
        const g = gameData[id]
        if (!g) return ''
        return `
          <div class="game-card rounded-xl p-3 flex items-center gap-3 cursor-pointer" data-game="${id}">
            <div class="w-14 h-14 rounded-lg bg-gradient-to-br ${g.gradient} flex items-center justify-center overflow-hidden">
              ${g.image ? `<img src="${g.image}" class="w-full h-full object-cover">` : `<span class="text-2xl">${g.emoji}</span>`}
            </div>
            <div class="flex-1 min-w-0">
              <h3 class="font-semibold text-sm">${g.title}</h3>
              <p class="text-xs text-gray-500 truncate">${g.tags?.[g.tags.length-1]?.text || ''} ‚Ä¢ ‚ô• ${count} Favs</p>
            </div>
            <div class="w-2 h-2 bg-green-500 rounded-full pulse-dot"></div>
          </div>
        `
      }).join('')

      container.querySelectorAll('.game-card').forEach(c => c.addEventListener('click', () => openGameDetail(c.dataset.game)))
    }

    // ==================== AUTH ====================
    async function signIn(username, pin) {
      const user = allData.find(u => u.type === 'user' && u.username === username && u.pin === pin)
      if (user) {
        currentUser = user
        updateProfileDisplay()
        document.getElementById('signin-modal')?.classList.add('hidden')
        showMessage(`Bienvenue ${username} ! üî•`)
        refreshData()
        return true
      }
      document.getElementById('signin-error').textContent = 'Nom ou PIN incorrect'
      document.getElementById('signin-error').classList.remove('hidden')
    }

    async function createAccount(username, pin) {
      if (allData.some(u => u.type === 'user' && u.username.toLowerCase() === username.toLowerCase())) {
        document.getElementById('create-error').textContent = 'Nom d√©j√† pris'
        document.getElementById('create-error').classList.remove('hidden')
        return false
      }

      const newUser = {
        type: 'user',
        username,
        pin,
        favorites: '',
        profile_picture: '',
        created_at: new Date().toISOString()
      }

      const { isOk } = await saveRecord(newUser)
      if (isOk) {
        await refreshData()
        showMessage('Compte cr√©√© ! üéâ')
        return true
      }
      return false
    }

    function signOut() {
      currentUser = null
      isAdminMode = false
      updateProfileDisplay()
      document.getElementById('profile-modal')?.classList.add('hidden')
      showMessage('D√©connect√©')
    }

    // ==================== FAVORITES ====================
    async function toggleFavorite(gameId) {
      if (!currentUser) return showMessage('Connecte-toi pour ajouter aux favoris')

      const favs = currentUser.favorites ? currentUser.favorites.split(',').filter(Boolean) : []
      const index = favs.indexOf(gameId)

      if (index > -1) {
        favs.splice(index, 1)
        showMessage('Retir√© des favoris')
      } else {
        favs.push(gameId)
        showMessage('Ajout√© aux favoris ‚ù§Ô∏è')
      }

      currentUser.favorites = favs.join(',')
      await saveRecord(currentUser)
      await refreshData()
      updateHeartState(gameId)
    }

    function updateHeartState(gameId) {
      const icon = document.getElementById('heart-icon')
      if (!icon) return
      if (!currentUser) {
        icon.setAttribute('fill', 'none')
        icon.classList.remove('text-red-500')
        return
      }
      const favs = currentUser.favorites?.split(',').filter(Boolean) || []
      const isFav = favs.includes(gameId)
      icon.setAttribute('fill', isFav ? 'currentColor' : 'none')
      icon.classList.toggle('text-red-500', isFav)
    }

    // ==================== PROFILE PICTURE ====================
    async function updateProfilePicture(url) {
      if (!currentUser) return
      currentUser.profile_picture = url || ''
      await saveRecord(currentUser)
      await refreshData()
      showMessage(url ? 'Photo mise √† jour !' : 'Photo supprim√©e')
    }

    function updateProfileDisplay() {
      const usernameEl = document.getElementById('profile-username')
      const picImg = document.getElementById('profile-picture-img')
      const picEmoji = document.getElementById('profile-picture-emoji')
      const btnImg = document.getElementById('profile-btn-img')
      const btnIcon = document.getElementById('profile-btn-icon')

      if (currentUser) {
        usernameEl.textContent = currentUser.username
        if (currentUser.profile_picture) {
          picImg.src = currentUser.profile_picture
          picImg.classList.remove('hidden')
          picEmoji.classList.add('hidden')
          btnImg.src = currentUser.profile_picture
          btnImg.classList.remove('hidden')
          btnIcon.classList.add('hidden')
        } else {
          picImg.classList.add('hidden')
          picEmoji.classList.remove('hidden')
          btnImg.classList.add('hidden')
          btnIcon.classList.remove('hidden')
        }
        document.getElementById('welcome-msg').textContent = `Welcome back, ${currentUser.username}`
      } else {
        usernameEl.textContent = 'Guest Player'
        picImg.classList.add('hidden')
        picEmoji.classList.remove('hidden')
        btnImg.classList.add('hidden')
        btnIcon.classList.remove('hidden')
        document.getElementById('welcome-msg').textContent = 'Welcome back, Player'
      }
    }

    // ==================== ADMIN NEWS ====================
    document.getElementById('add-news-form')?.addEventListener('submit', async e => {
      e.preventDefault()
      const title = document.getElementById('news-title')?.value.trim()
      const description = document.getElementById('news-description')?.value.trim()
      const link = document.getElementById('news-link')?.value.trim()

      if (!title || !description) return showMessage('Titre et description requis')

      await saveRecord({
        type: 'news',
        title,
        description,
        link: link || null,
        created_at: new Date().toISOString()
      })

      e.target.reset()
      await refreshData()
      showMessage('News publi√©e ! üöÄ')
    })

    window.deleteNews = async function(id) {
      if (confirm('Supprimer cette news ?')) {
        await deleteRecord(id)
        await refreshData()
        showMessage('News supprim√©e')
      }
    }

    function renderAdminNewsList() {
      const list = document.getElementById('admin-news-list')
      if (!list) return

      const news = allData.filter(i => i.type === 'news').sort((a,b) => new Date(b.created_at) - new Date(a.created_at))

      list.innerHTML = news.length === 0
        ? '<div class="text-center py-4 text-gray-500 text-sm">No news items yet</div>'
        : news.map(item => `
          <div class="p-3 rounded-xl bg-white/5 border border-white/10 space-y-2">
            <div class="flex items-start justify-between gap-2">
              <div class="flex-1 min-w-0">
                <h4 class="font-semibold text-sm">${item.title}</h4>
                <p class="text-xs text-gray-500 mt-1">${getTimeAgo(new Date(item.created_at))}</p>
              </div>
              <button onclick="deleteNews('${item.id}')" class="w-8 h-8 rounded-lg bg-red-500/20 text-red-400 hover:bg-red-500/30 flex items-center justify-center">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/></svg>
              </button>
            </div>
            <p class="text-xs text-gray-400">${item.description}</p>
          </div>
        `).join('')
    }

    // ==================== ADMIN FEATURED ====================
    document.getElementById('save-featured-btn')?.addEventListener('click', async () => {
      const g1 = document.getElementById('featured-game-1')?.value
      const g2 = document.getElementById('featured-game-2')?.value

      if (!g1 || !g2 || g1 === g2) return showMessage('Choisis deux jeux diff√©rents')

      let settings = allData.find(i => i.type === 'settings') || { type: 'settings' }
      settings.featured1 = g1
      settings.featured2 = g2

      await saveRecord(settings)
      await refreshData()
      document.getElementById('admin-featured-modal')?.classList.add('hidden')
      showMessage('Jeux mis en avant mis √† jour ! ‚≠ê')
    })

    // ==================== UTILS ====================
    function showMessage(msg) {
      const div = document.createElement('div')
      div.className = 'fixed top-20 left-1/2 -translate-x-1/2 bg-red-600 text-white px-6 py-3 rounded-xl shadow-lg z-[60] fade-in'
      div.textContent = msg
      document.body.appendChild(div)
      setTimeout(() => div.remove(), 3000)
    }

    function getTimeAgo(date) {
      const seconds = Math.floor((new Date() - date) / 1000)
      let interval = seconds / 31536000
      if (interval > 1) return Math.floor(interval) + ' years ago'
      interval = seconds / 2592000
      if (interval > 1) return Math.floor(interval) + ' months ago'
      interval = seconds / 86400
      if (interval > 1) return Math.floor(interval) + ' days ago'
      interval = seconds / 3600
      if (interval > 1) return Math.floor(interval) + ' hours ago'
      interval = seconds / 60
      if (interval > 1) return Math.floor(interval) + ' minutes ago'
      return 'Just now'
    }

    // ==================== D√âMARRAGE ====================
    refreshData()

    // Admin mode (hold 2s sur settings header)
    let holdTimer
    document.getElementById('settings-header')?.addEventListener('mousedown', () => {
      if (currentUser?.username === 'DreamQc' || currentUser?.username === 'Thaxt') {
        holdTimer = setTimeout(() => {
          isAdminMode = true
          document.getElementById('admin-buttons')?.classList.remove('hidden')
          showMessage('Mode Admin activ√© üî•')
        }, 2000)
      }
    })
    document.getElementById('settings-header')?.addEventListener('mouseup mouseleave', () => clearTimeout(holdTimer))
  </script>
 </body>
</html>
